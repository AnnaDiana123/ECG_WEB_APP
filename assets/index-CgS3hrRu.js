import{getFirestore as u,doc as d,getDoc as l}from"https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";import{getAuth as m,setPersistence as p,browserSessionPersistence as f,signInWithEmailAndPassword as g}from"https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";import{initializeApp as h}from"https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(e){if(e.ep)return;e.ep=!0;const r=t(e);fetch(e.href,r)}})();const w={apiKey:"AIzaSyBOesAtQekwBT9_yuXpoaGCg6gmxiizzP4",authDomain:"ecgapp-7d874.firebaseapp.com",projectId:"ecgapp-7d874",storageBucket:"ecgapp-7d874.appspot.com",messagingSenderId:"931292339686",appId:"1:931292339686:web:2f75e50b490be933f94a27",measurementId:"G-2BE9FVBPMW"},c=h(w),y=u(c),a=m(c),I=async(o,s)=>{try{await p(a,f);const t=await g(a,o,s);return sessionStorage.setItem("user-creds",JSON.stringify(t.user)),t.user}catch(t){throw console.error("Error signing in:",t),t}},b=async o=>{const s=d(y,"UserAuthList",o),t=await l(s);return t.exists()?t.data():null};let E=document.getElementById("emailInput"),P=document.getElementById("passwordInput"),A=async o=>{o.preventDefault();try{const t=(await I(E.value,P.value)).uid,n=await b(t);if(n){const e=n.Role;if(e==="Admin")window.location.href="./html/admin/adminHome.html";else if(e==="User")window.location.href="./html/user/userHome.html";else throw new Error("Invalid user role")}else throw new Error("User document does not exist")}catch(s){alert(s.message)}};MainForm.addEventListener("submit",A);
