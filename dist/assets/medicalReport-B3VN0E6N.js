import"./modulepreload-polyfill-B5Qt9EMX.js";import{f as p,a as f}from"./dataServices-BLqrFuHg.js";import"https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";import"./firebaseConfig-HqSgYK5z.js";import"https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";import"https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";function B(){const{jsPDF:t}=window.jspdf;new t({orientation:"portrait",unit:"pt",format:"a4"}).html(document.querySelector(".container"),{callback:function(n){for(var e=n.internal.getNumberOfPages();e>1;)n.deletePage(e),e=n.internal.getNumberOfPages();n.save("medical-report.pdf")},x:10,y:10,margin:[10,10,10,10],width:500,windowWidth:1e3})}function b(t){let r=new Date(t),n=Date.now()-r.getTime(),e=new Date(n);return Math.abs(e.getUTCFullYear()-1970)}const I=(t,r)=>r=="female"?t<50?{rmssdRange:{min:16.4,max:56.6},sdnnRange:{min:25.7,max:64.1},bpmRange:{min:60,max:100},rrIntervalRange:{min:550,max:1200}}:{rmssdRange:{min:8.8,max:35.2},sdnnRange:{min:18,max:45.2},bpmRange:{min:60,max:100},rrIntervalRange:{min:550,max:1200}}:t<50?{rmssdRange:{min:15.7,max:52.3},sdnnRange:{min:27,max:64.6},bpmRange:{min:60,max:100},rrIntervalRange:{min:550,max:1200}}:{rmssdRange:{min:9.5,max:31.5},sdnnRange:{min:18.2,max:47.8},bpmRange:{min:60,max:100},rrIntervalRange:{min:550,max:1200}},R=(t,r,n,e,a,m,o,s)=>{let i,l,c,g="",u,h,x,y="";t<a.min?(i="Your resting heart rate is below 60 BPM, which might indicate bradycardia.",u="red"):t>a.max?(i="Your resting heart rate is above 100 BPM, which might indicate tachycardia.",u="red"):(i="Your resting heart rate is within the normal range (60-100 BPM).",u="black"),r<m.min?(l="Your heart rate variability is low, suggesting reduced flexibility in your heart's response. This can be caused by stress, fatigue, or chronic health conditions.",h="red"):r>m.max?(l="Your heart rate variability is high, which might indicate a very responsive nervous system. This can be seen in highly relaxed or fit individuals but can also occur due to some medical conditions.",h="red"):(l="Your heart rate variability (SDNN) is within the normal range.",h="black"),n<o.min?(c="Your short-term heart rate variability is low, which might mean your heart isn't responding well to changes. This can be due to stress, lack of sleep, or certain health conditions.",x="red"):n>o.max?(c="Your short-term heart rate variability is high, which might mean your heart is very responsive to changes. This can be seen in relaxed or well-rested individuals but might also be due to some medical conditions.",x="red"):(c="Your short-term heart rate variability (RMSSD) is within the normal range.",x="black");for(let d=0;d<e.length;d++)if(e[d]<s.min||e[d]>s.max){g=`One of your RR intervals (${e[d]} ms) is outside the normal range. This could indicate an irregular heartbeat or other cardiac issue.`,y="red";break}g==""&&(g="Your RR intervals are within the normal range.",y="black"),document.getElementById("bpmText").innerText=i,document.getElementById("bpmText").style.color=u,document.getElementById("sdnnText").innerText=l,document.getElementById("sdnnText").style.color=h,document.getElementById("rmssdText").innerText=c,document.getElementById("rmssdText").style.color=x,document.getElementById("rrIntervalsText").innerText=g,document.getElementById("rrIntervalsText").style.color=y},v=async()=>{const t=new URLSearchParams(window.location.search),r=t.get("userId"),n=t.get("batchId"),e=await p(r),a=await f(r,n);if(e?(document.getElementById("referneceRangeText").textContent=`Reference Range ( ${e.Gender}, Age ${b(e.Birthday)} )`,document.getElementById("summaryText").textContent=`The values for RMSSD, RR Intervals, BPM, and SDNN provided in this report have been extracted from an approximately one-minute ECG reading that commenced at ${new Date(Number(n))}.`,document.getElementById("patientName").textContent=e.Name,document.getElementById("patientAge").textContent=b(e.Birthday),document.getElementById("patientGender").textContent=e.Gender,document.getElementById("reportDate").textContent=new Date(Number(n))):alert("url parameters are not correct"),a&&e){document.getElementById("rrIntervalsValue").textContent=a.rr_intervals.join(", "),document.getElementById("bpmValue").textContent=`${a.bpm} bpm`,document.getElementById("sdnnValue").textContent=`${a.sdnn} ms`,document.getElementById("rmssdValue").textContent=`${a.rmssd} ms`;const{rmssdRange:m,sdnnRange:o,bpmRange:s,rrIntervalRange:i}=I(b(e.Birthday),e.Gender);document.getElementById("rrIntervalsRange").textContent=`${i.min} - ${i.max} ms`,document.getElementById("bpmRange").textContent=`${s.min} - ${s.max} bpm`,document.getElementById("sdnnRange").textContent=`${o.min} - ${o.max} ms`,document.getElementById("rmssdRange").textContent=`${m.min} - ${m.max} ms`,R(a.bpm,a.sdnn,a.rmssd,a.rr_intervals,s,o,m,i)}else alert("url parameters are not correct")};document.addEventListener("DOMContentLoaded",async()=>{document.getElementById("generatePdfButton").addEventListener("click",B),v()});
